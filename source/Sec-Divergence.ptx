<?xml version="1.0" encoding="UTF-8" ?>
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="Sec_Divergence">

<!-- Copyright 2018-2020 Joel Feldman, Andrew Rechnitzer and Elyse Yeager -->
<!-- This work is licensed under the Creative Commons Attribution-NonCommercial-ShAirelike 4.0 International License-->
<!-- https://creativecommons.org/licenses/by-nc-sa/4.0 -->

<title>Le Théorème de la divergence</title>
<introduction>

  <p>Dans cette section nous verrons le troisième des théorèmes classiques du calcul vectoriel, à savoir, le Théorème de la divergence. Ce résultat est aussi connu sous le nom de Théorème de Gauss, ou encore Théorème d'Ostrogradsky.
  </p>

  <p>
    Le Théorème de Stokes est une généralisation de ce que nous avons appelé la <xref ref="thm_Green_tgt">forme tangentielle du Théorème de Green</xref>. En effet, celui-ci traite de régions dans le plan, tandis que le <xref ref="thm_Stokes"> Théorème de Stokes </xref> traite de surfaces dans l'espace. Le Théorème de Stokes restreint aux surfaces du plan devient le Théorème de Green (forme tangentielle).
  </p>

  <p>
    Une autre généralisation est possible :  plutôt que de passer de surfaces dans le plan à des surfaces dans l'espace, nous pouvons passer de régions planes dont le bord est une courbe fermée (ou une réunion de courbes fermées) à des régions solides dont le bord est une surface fermée (ou une réunion de surfaces fermées) et nous intéresser au flux d'un champ de vecteurs à travers la surface en question. La <xref ref="thm_Green-norm">version normale du Théorème de Green</xref> devient alors le Théorème de la divergence.
  </p>

</introduction>

<subsection xml:id="pars-Regions-bords">
  <title>Régions dans l'espace et leurs bords</title>
  <p>
    Pour commencer nous allons considérer des régions de <m>\R^3</m> avec lesquelles il est aisé de travailler. Lorsque nous avons étudié les intégrales triples, nous avons défini ce qu'une région <em>élémentaire</em> est (voir la <xref ref="def-Elementaire-3">définition</xref>). Une région de <m>\R^3</m> sera dite <terms>simple</terms> si elle est simultanément des types <xref ref="z-simple-3d"/>, <xref ref="y-simple-3d"/> et <xref ref="x-simple-3d"/>.
  </p>
  <p>
    Une telle région admet pour frontière une surface <m>\cS = \partial \cE</m> qui est la réunion de surfaces lisses. De plus, nous allons convenir que <m>\cS</m> sera orientée vers l'extérieur de <m>\cE</m>. Nous adopterons cette convention pour toute surface fermée (c'est à dire qui est le bord d'une région solide).
  </p>
  <example xml:id="ex-region-3d-bord">
    <statement>
      <p>
        Soit <m>\cE</m> la région de <m>\R^3</m> bornée par le cylindre parabolique <m>y=x^2</m> et les plans <m>z=0</m> et <m>y+z=1</m>.

      </p>
      <figure xml:id="fig-region3d-bord">
          <caption>La région <m>\cE</m> de <m>\R^3</m> et sa frontière.</caption>

          <image xml:id="im-region3d-bornes" platform="sage" width="100%">

            <sageplot variant="3d" aspect="1.0">
              var('x,y,z')
              Base = parametric_plot3d([(1-y)*x+y,(1-y)*x^2 + y,0],(x,-1,1), (y,0,1), color = "orange", opacity = 0.35,frame = False, projection = 'orthographic')
              Cyl = parametric_plot3d([x,x^2, (1-y)*(1-x^2)],(x,-1,1),(y,0,1), color = "green", opacity = 0.35,frame = False)
              Plan = parametric_plot3d([(1-y)*x+y,(1-y)*x^2 + y,1-(1-y)*x^2 - y ],(x,-1,1), (y,0,1), color = "blue", opacity = 0.35,frame = False)
              Fig = Base + Cyl + Plan
              Fig += arrow3d((0,0,0),(1.3,0,0), width=0.5, color = "black",frame = False)
              Fig += text3d("x", (1.4,0,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,1.3,0), width=0.5, color = "black",frame = False)
              Fig += text3d("y", (0,1.4,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,0,1.3), width=0.5, color = "black",frame = False)
              Fig += text3d("z", (0,0,1.4), color = "black",frame = False)
              Fig += arrow3d((0.5,0.7,0),(0.5,0.7,-0.5), width=0.75, color = "orange",frame = False)
              Fig += arrow3d((-0.5, 0.7, 0.3), (-0.5,1.05,0.65), width=0.75, color = "blue",frame = False)
              Fig += arrow3d((0.5, 0.25, 0.5), (0.85,-0.1,0.5), width=0.75, color = "green",frame = False)
              Fig
            </sageplot>
          </image>
      </figure>
      <p>
        Le bord de <m>\cE</m> est formé de <m>3</m> surfaces :
        <ol>
          <li>
            <p>
              <m>\cS_1 :</m> la portion du plan <m>z=0</m> limitée par les inégalités <m>-1\leqslant  x \leqslant  1</m> et <m>x^2 \leqslant  y  \leqslant  1</m>. Dans cette région, le vecteur normal à la surface est <m>\vn_1 = - \vk</m> (en orange dans la figure). C'est le bord inférieur de <m>\cE</m>, en orange dans la figure.
            </p>
          </li>
          <li>
            <p>
              <m>\cS_2 :</m> la portion du cylindre <m>y=x^2</m> comprise entre le plan <m>z=0</m> et le plan <m>y+z=1</m>.  C'est la partie latérale du bord de <m>\cE</m>, elle est en vert dans la figure. Le vecteur normal sur cette portion du bord de <m>\cE</m> est <m>\vn_2 = 2x\vi - \vj</m> (en vert).
            </p>
          </li>
          <li>
            <p>
              <m>\cS_3 :</m> la portion du plan <m>z=1-y</m> qui se trouve au dessus de la région du plan <m>z=0</m> que nous avons nommé <m>\cS_1</m> ci haut, il s'agit du bord supérieur de <m>\cE</m>, en bleu dans la figure ci-haut. Le vecteur normal correspondant est <m>\vn_3 = \vj + \vk</m>, en bleu.
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <solution>
      <p>

      </p>
    </solution>
  </example>

</subsection>

<subsection xml:id="pars-divergence">
  <title>Le Théorème de la divergence</title>
  <p>
    Nous pouvons maintenant énoncer le Théorème de la divergence. En essence il dit que le flux d'un champ <m>\vF</m> vers l'extérieur d'une région <m>\cE</m>, c'est à dire l'intégrale double de <m>\vF</m> à travers la surface  <m>\cS = \partial \cE</m> est égal à l'intégrale triple de la divergence de <m>\vF</m> sur toute la région <m>\cE.</m>
  </p>
  <p>
    De façon plus précise nous avons :
  </p>
  <theorem xml:id="thm_divThm">
    <title>Théorème de la divergence</title>


    <statement>
      <p>Soit <m>\cE</m> une région simple de <m>\R^3</m> et <m>\cS = \partial \cE</m> orientée vers l'extérieur de <m>\cE</m>. Soit <m>\vF</m> un champ de vecteurs de classe <m>C^1</m> sur une region contenant <m>\cE</m> dans son intérieur. Alors
      <me>
        \iint_{\partial \cE} \vF \cdot d\vS = \iiint_ \cE \vnabla \cdot \vF\, dV
      </me>
      </p>
    </statement>
  </theorem>

  <p>
    Remarquons que si <m>\vF = P\,\vi + Q\, \vj + R\, \vk</m>, l'intégrale triple s'écrit
    <me>
       \iiint_ \cE \vnabla \cdot \vF\, dV =  \iiint_ \cE \div \vF\, dV =  \iiint_ \cE P_x + Q_y + R_z\, dV
    </me>
  </p>
  <p>
    Voyons quelques exemples.
  </p>
  <example xml:id="ex-divergence-a">
    <statement>
      <p>
        Soit <m>\vF =(x^3 + y^3)\vi + (y^3 + z^3)\vj + (z^3+ x^3)\vk</m>. Calculer le flux de <m>\vF</m> vers l'extérieur de la sphère <m>x^2 + y^2 + z^2 = 1</m>

      </p>
    </statement>
    <solution>
      <p>Soit <m>\cE</m> la boule unité, c'est à dire la région de <m>\R^3</m> verifiant <m>x^2+ y^2 + z^2 \leqslant  1</m>. Nous avons <m>\partial \cE = \cS</m> est la sphère donnée.
      </p>
      <p>
        Par ailleurs, écrivons <m>\vF = P\,\vi + Q \,\vj + R\, \vk</m>. Nous calculons alors
      </p>
      <me>
        \vnabla \vF = \div \vF = P_x + Q_y + R_z = 3x^2+ 3y^2 + 3z^2
      </me>
      <p>
        Ainsi, le flux qui nous intéresse est calculé par une intégrale triple, qu'on évalue en utilisant les coordonnées sphériques :
      </p>
      <md>
        <mrow>\iint_{\cS = \partial \cE} \amp = \iiint_{\cE} 3(x^2+ y^2 + z^2) </mrow>
        <mrow> \amp = \int_0^{2\pi} \int_0^{\pi} \int_0^1 3\rho^2 \, \rho^2\, \sin \phi\, d \rho\, d\phi\, d\theta</mrow>
        <mrow>  \amp = 3\left(\int_0^{2\pi}d\theta\right)\left(\int_0^\pi\sin \phi\, d\phi\right)\left(\int_0^1\rho^4\, d\rho\right) </mrow>
        <mrow>  \amp = 3\cdot 2\pi \cdot 2 \cdot \frac{1}{5} = \frac{12\pi}{5} </mrow>
      </md>

    </solution>
  </example>

  <example>
    <statement>
      <p>
        Soit <m>\cE</m> la région limitée par le cylindre <m>y=x^2</m> et les plans <m>z=0</m> et <m>y+z=1</m> (c'est la région de l'<xref ref="ex-region-3d-bord"> exemple </xref>, voir aussi la   <xref ref="fig-region3d-bord">figure </xref>)
      </p>
    </statement>
    <solution>
      <p>Posons <m>\vF = P\,\vi + Q\, \vj + R\,\vk</m>. On calcule la divergence du champ <m>\vF</m>
      </p>
      <me>
        \vnabla \cdot \vF = \div \vF = P_x\, \vi + Q_y\,\vj + R_z\, \vk = y+2y+0= 3y
      </me>
      <p>
        Le Théorème de la divergence nous permet de ramener le calcul de l'intégrale de flux à une intégrale triple. À l'<xref ref="Int-3-ex1">exemple</xref> nous avons déjà considéré cette région et établi les bornes d'intégration. On obtient alors
      </p>
      <md>
        <mrow>\iint_{\cS} \vF \cdot d\vS = \iint_{\cE} \vnabla \cdot \vF\, dV \amp = \iiint_{\cE} 3y \, dV </mrow>
        <mrow> \amp = \int_{-1}^{1} \int_{x^2}^1 \int_0^{1-y} 3y\, dz\, dy\, dx</mrow>
        <mrow>  \amp = 3 \int_{-1}^1 \int_{x^2}^1 y(1-y)\, dy\, dx </mrow>
        <mrow>  \amp = 3 \int_{-1}^1 \frac{1}{3}x^6 - \frac{1}{2}x^4 + \frac{1}{6}</mrow>
        <mrow>  \amp =  8/35</mrow>
      </md>

    </solution>
  </example>

  <p>
    Voyons maintenant un exemple montrant comment utiliser le théorème de la divergence pour calculer le flux d'un champ à travers une surface qui n'est pas fermée. On comparera avec <xref ref="Green-fermer-courbe">l'exemple</xref>.
  </p>


  <example xml:id="ex-div-fermer-surface">
    <statement>
      <p>
        Soit <m>\vF = xy\, \vi + yz\, \vj + xz\, \vk </m> et <m>\cS</m> la surface limitée par les plans de coordonnées et les plans <m>x=1</m> et <m>y=1</m>. Calculer le flux de <m>\vF</m> à travers <m>\cS</m>, orientée vers l'extérieur du cube.
      </p>
    </statement>
    <solution>
      <p>
        Notons pour commencer que la surface <m>\cS</m> n'est pas le bord d'une région solide, il ne s'agit pas d'une surface fermée.
      </p>
      <figure xml:id="fig-ex-div-fermer-surface">
          <caption>La surface qui nous intéresse est coloriée en gris. Ce sont 5 des 6 faces du cube. La face manquante est celle en brun. Le champ de vecteurs se trouve également représenté.</caption>
          <sidebyside width="85%">
          <image xml:id="im-ex-div-fermer-surface" platform="sage">
            <sageplot variant="3d" aspect="1.0">
              var('x,y,z')
              Fig = plot_vector_field3d([x*y,y*z,x*z], (x,0,1), (y,0,1), (z,0,1), plot_points=[4,4,4])
              Fig += polygon3d([[0, 0, 0], [1,0,0], [1,1,0], [0,1,0]], color="grey", alpha=1)
              Fig += polygon3d([[1,1,0], [0,1,0], [0,1,1], [1,1,1]], color="grey", alpha=1)
              Fig += polygon3d([[0,0,0],[1,0,0],[1,0,1],[0,0,1]], color="grey", alpha=1)
              Fig += polygon3d([[0,0,0],[0,1,0],[0,1,1],[0,0,1]], color="grey", alpha=1)
              Fig += polygon3d([[1,0,0],[1,1,0],[1,1,1],[1,0,1]], color="grey", alpha=1)
              Fig += polygon3d([[0, 0, 1], [1,0,1], [1,1,1], [0,1,1]], color="brown", alpha=1)
              Fig += line3d([[0, 0, 0], [1,0,0], [1,1,0], [0,1,0],[0,0,0]], color="black", thickness= 5)
              Fig += line3d([[0, 0, 1], [1,0,1], [1,1,1], [0,1,1],[0,0,1]], color="black", thickness= 5)
              Fig += line3d([[0, 0, 0], [0,0,1]], color="black", thickness= 5)
              Fig += line3d([[0, 1, 0], [0,1,1]], color="black", thickness= 5)
              Fig += line3d([[1, 0, 0], [1,0,1]], color="black", thickness= 5)
              Fig += line3d([[1, 1, 0], [1,1,1]], color="black", thickness= 5)
              Fig += arrow3d((0,0,0),(1.5,0,0), width=0.5, color = "black",frame = False)
              Fig += text3d("x", (1.7,0,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,1.5,0), width=0.5, color = "black",frame = False)
              Fig += text3d("y", (0,1.7,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,0,1.5), width=0.5, color = "black",frame = False)
              Fig += text3d("z", (0,0,1.7), color = "black")
              Fig
            </sageplot>
          </image>
          </sidebyside>
      </figure>


      <p>
        En effet, si <m>\cE</m> est le cube unité, alors <m>\partial \cE</m> est formée de <m>\cS</m> avec en plus le carré de sommets <m>(0,0,1), (0,1,1), (1,0,1), (1,1,1)</m>. Soit donc <m>\cS'</m> ce carré, de sorte que <m>\partial \cE = \cS \cup \cS'</m>. On peut appliquer le théorème de la divergence au cube <m>\cE</m>, ce qui nous donnera
        <md>
          <mrow xml:id="eg-div-eq1" tag = "star"> \iiint_{\cE} \vnabla \cdot \vF \, dV  \amp = \iint_{\cS} \vF \cdot d\vS + \iint_{\cS'} \vF \cdot d\vS </mrow>
        </md>

      </p>
      <p>
        Le flux qui nous intéresse est le premier terme de la somme, tout à droite. Nous allons calculer le terme de gauche (l'intégrale triple), ainsi que le tout dernier terme pour déduire la valeur qui nous intéresse.
      </p>
      <p>
      Pour ceci on commence par calculer <m> \vnabla \cdot \vF = y+z+x </m>, de sorte que
      <md>
        <mrow>\iiint_{\cE}\vnabla \cdot \vF\, dV  \amp = \int_0^1 \int_0^1 \int_0^1 x+y+z\, dz\, dy\, dx </mrow>
        <mrow> \amp = \int_0^1 \int_0^1 x+y+\frac{1}{2}\, dy\, dx</mrow>
        <mrow>  \amp = \int_0^1 x+1\, dx = \frac{3}{2} </mrow>
      </md>
      </p>
      <p>
        Calculons maintenant le flux à travers <m>\cS'</m>. Sur cette surface, nous avons <m>z=1</m> et le vecteur normal est <m>\vk</m>. Ainsi, sur <m>\cS'</m>
      </p>
      <me>
        \vF \cdot  \vk = (xy\, \vi + y\,\vj + x\,\vk)\cdot \vk = x
      </me>
      <p>
        On calcule alors
      </p>
      <me>
        \iint_{\cS'} \vF \cdot d\vS = \iint_{\cS'} \vF \cdot \vn\, dS = \iint_{[0,1]\times[0,1]} x\, dA = \frac{1}{2}
      </me>
      <p>
        L'égalité <xref ref="eg-div-eq1"/>, ci-haut devient alors
      </p>
      <me>
        \frac{3}{2} = \iint_{\cS}\vF \cdot d\vS + \frac{1}{2}
      </me>
      <p>
        et on déduit que le flux qui nous intéresse vaut <m>1</m>.
      </p>
      <p>
        Notons que <m>\cS</m> est formée de 5 surfaces, on pourrait dont calculer notre flux avec 5 intègrales de surface. Aucune d'elles n'est particulièrement difficile, c'est un peu long.
      </p>
    </solution>
  </example>
  <p>
    Voyons maintenant un autre exemple montrant comment calculer un flux à l'aide du théorème de la divergence.
  </p>


  <example xml:id="eg_divThmB">
    <statement>
      <p>
        Calculer le flux  <m>\displaystyle \iint_{\cS} \vF \cdot d\vS</m> où <m>\vn </m> est le vecteur normal unitaire pointant vers l'extérieur de <m>\cS</m>, la portion de la surface <m>z^2=x^2+y^2</m> vérifiant <m>1\leqslant z\leqslant 2</m>, et où

        <me>
          \vF = 3x\,\vi + (5y+e^{\cos x})\,\vj + z\,\vk
        </me>
      </p>
    </statement>

    <solution>
      <p>
        Le terme <m>e^{\cos x}</m> dans  <m>\vF</m> suggère qu'une évaluation directe de l'intégrale peut être ardue<fn>En fait, il est possible d'évaluer l'intégrale directement. Il suffit de remarquer que la partie problématique est une fonction impaire par rapport à <m>y</m>, et donc son intégrale est nulle.</fn> et nous utilisons à nouveau le théorème de la divergence. À nouveau, <m>\cS</m> n'est pas la frontière d'une région solide  <m>\cE</m>. Il s'agit de la portion du cône illustré dans la figure ci-après. Il manquerait un couvercle en haut et un autre en bas.
      </p>
      <figure xml:id="fig-eg_divThmB">
          <caption>La surface <m>\cS</m> (en orange foncé) est une portion du cône <m>x^2 + y^2 = z^2</m>. Avec en plus les deux disques horizontaux (en gris) elle constitue la frontière d'une région solide  <m>\cE</m> de <m>\R^3</m>.</caption>

          <image xml:id="im-eg_divThmB" platform="sage" width="100%">

            <sageplot variant="3d" aspect="1.0">
              var('r,t')
              Fig = parametric_plot3d([r*cos(t), r*sin(t), r], (r,1,2), (t,0,2*pi), color = "orange", opacity = 0.85)
              Fig += parametric_plot3d([r*cos(t), r*sin(t), r], (r,0,1), (t,0,2*pi), color = "orange", opacity = 0.25)
              Fig += parametric_plot3d([r*cos(t), r*sin(t), r], (r,2,2.5), (t,0,2*pi), color = "orange", opacity = 0.25)
              Fig += parametric_plot3d([r*cos(t), r*sin(t), 1], (r,0,1), (t,0,2*pi), color = "gray", opacity = 0.85)
              Fig += parametric_plot3d([r*cos(t), r*sin(t), 2], (r,0,2), (t,0,2*pi), color = "gray", opacity = 0.85)
              Fig += arrow3d((1,1,sqrt(2)),(3/2,3/2,sqrt(2)/2), width=1, color = "blue",frame = False)
              Fig += text3d("n", (1.7,1.7,0.7), color = "blue")
              Fig += arrow3d((0,0,0),(2.5,0,0), width=0.7, color = "black",frame = False)
              Fig += text3d("x", (2.7,0,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,2.5,0), width=0.7, color = "black", frame = False)
              Fig += text3d("y", (0,2.7,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,0,3), width=0.7, color = "black",frame = False)
              Fig += text3d("z", (0,0,3.2), color = "black")
              Fig
            </sageplot>
          </image>
      </figure>
      <p>
        Heureusement nous avons une région solide <m>\cE</m> dont la frontière, sans être égale à <m>\cS</m>, contient  <m>\cS</m>. Il s'agit de
        <me>
          \cE = \Set{(x,y,z)}{x^2+y^2\leqslant z^2,\  1\leqslant z\leqslant 2}
        </me>
        Le bord, <m>\partial \cE</m> est la réunion de  <m>\cS</m> et deux disques
        <md>
          <mrow>
            \cD_1 &amp;= \Set{(x,y,z)}{x^2+y^2\leqslant z^2,\ \ z=1}
          </mrow>
          <mrow>
            \cD_2 &amp;= \Set{(x,y,z)}{x^2+y^2\leqslant z^2,\ \ z=2}
          </mrow>
        </md>
        Le théorème de la divergence donne alors.

        <md>
          <mrow>
            \iiint_{\cE}\vnabla\cdot\vF\ \dee{V} &amp;= \iint_{\partial V} \vF \cdot d\vS
          </mrow>
          <mrow>
            &amp;= \iint_{\cS} \vF \cdot d\vS + \iint_{\cD_1} \vF \cdot d\vS +\iint_{\cD_2} \vF \cdot d\vS
          </mrow>
        </md>
        ce qui implique
        <md>
          <mrow>
            \iint_{\cS} \vF \cdot d\vS &amp;= \iiint_{\cE}\vnabla\cdot\vF\ \dee{V}  -\iint_{\cD_1} \vF \cdot d\vS -\iint_{\cD_2} \vF \cdot d\vS
          </mrow>
        </md>
        Le terme de gauche, celui que nous voulons avoir, n'est pas facile à calculer directement. Cependant, les trois autres termes, ceux de droite, se calculent aisément.
      </p>
      <p>
        Le vecteur normal pour le disque horizontal  <m>\cD_2</m> est <m>+\vk</m>, ainsi
        <md>
          <mrow>
            \iint_{\cD_2} \vF \cdot d\vS &amp;=\iint_{\cD_2} \vF\cdot\vk\,\dee{S} = \iint_{\cD_2} z\,\dee{S}
          </mrow>
        </md>
        Comme <m>z=2</m> sur <m>\cD_2</m>, qui est un disque de rayon <m>2</m>, nous avons

        <me> \iint_{\cD_1} \vF \cdot d\vS = 2\text{Aire}(\cD_2)  =2\pi 2^2 = 8\pi
        </me>
      </p>
      <p>
        De la même façon, le vecteur normal au disque horizontal <m>\cD_1</m> est <m>-\vk</m>, ainsi
        <md>
          <mrow>
            \iint_{\cD_1} \vF \cdot d\vS &amp;=-\iint_{\cD_1} \vF\cdot\vk\,\dee{S}
            =-\iint_{\cD_1} z\,\dee{S}
          </mrow>
        </md>
        Comme <m>z=1</m> sur <m>\cD_1</m>, qui est un disque de rayon <m>1</m>,
        <me>
          \iint_{\cD_1} \vF \cdot d\vS =\text{Aire}(\cD_1) = -\pi 1^2 = -\pi
        </me>
        Finalement, comme <m>\vnabla\cdot\vF = 3+5+1 = 9</m> nous avons
        <md>
          <mrow>
            \iiint_{\cE}\vnabla\cdot\vF\ \dee{V} = 9\,\text{Vol}(V)
          </mrow>
        </md>
      </p>
      <p>
        Le volume de <m>\cE</m> peut être calculé facilement de plusieurs façons. Nous le faisons avec une intégrale simple. Pour ceci nous découpons <m>\cE</m> en tranches horizontales, voir la figure ci-bas
      </p>
      <sidebyside width="25%">
        <image source="images/CLP4-figs/coneC"/>
      </sidebyside>

      <p>
        La tranche à la hauteur <m>z</m> a :
        <ul>
          <li>
            épaisseur <m>\dee{z}</m>,
          </li>
          <li>
            une section circulaire de rayon  <m>z</m> (puisque l'équation de la surface <m>\cS</m> est précisément <m>x^2+y^2=z^2</m>), et donc
          </li>
          <li>
             l'aire vaut  <m>\pi z^2</m> et
          </li>
          <li>
            le volume est <m>\pi z^2\,\dee{z}</m>.
          </li>
        </ul>
        Ainsi
        <md>
          <mrow>
            \iiint_{\cE}\vnabla\cdot\vF\ \dee{V} = 9 \,\text{Vol}(V) = 9\int_1^2 \pi z^2\,\dee{z} = 9\left[\frac{\pi z^3}{3}\right]_1^2 = 9\times \pi\frac{7}{3} =21\pi
          </mrow>
        </md>
        En bout de ligne,
        <md>
          <mrow> \iint_{\cS} \vF \cdot d\vS &amp;= \iiint_{\cE}\vnabla\cdot\vF\ \dee{V} - \iint_{\cD_1} \vF \cdot d\vS -\iint_{\cD_2} \vF \cdot d\vS
          </mrow>
          <mrow>
            &amp;= 21\pi - (-\pi) -8\pi =14\pi
          </mrow>
        </md>
      </p>

</solution>
</example>





  <warning xml:id="warn_divThm">
    <p>
      L'hypothèse à l'effet que le champ <m>\vF</m> admet des dérivées partielles continues sur toute la région <m>\cE</m> est cruciale. L'exemple ci-après le montre. Gardons à l'esprit que pour le Théorème de Green nous avons quelque chose de semblable, voir notamment la <xref ref="warn_Green">mise en garde </xref> ainsi que l'<xref ref="ex-contre-green">exemple </xref>.
    </p>
  </warning>



  <example xml:id="eg_divThmD">
    <p>Écrivons, comme à l'habitude, <m>\vr = x \vi + y\vj + z \vk</m> et considérons le champ
      <me>
        \vF = \frac{\vr}{|\vr|^3}
      </me>
    et la région de l'espace <m>\cE = \Set{(x,y,z)}{x^2+y^2+z^2\leqslant  1}</m>. Ainsi, si <m>\vr = (x,y,z) \ne\vZero</m>,
<md>
<mrow>
\vnabla\cdot\vF(x,y,z)
&amp;=\frac{\partial }{\partial x}\frac{x}{{\big[x^2+y^2+z^2\big]}^{3/2}}
+\frac{\partial }{\partial y}\frac{y}{{\big[x^2+y^2+z^2\big]}^{3/2}}
</mrow><mrow>
&amp;\hskip1in+\frac{\partial }{\partial z}\frac{z}{{\big[x^2+y^2+z^2\big]}^{3/2}}
</mrow><mrow>
&amp;=\frac{\big[x^2+y^2+z^2\big]-x\frac{3}{2}(2x)}{{\big[x^2+y^2+z^2\big]}^{5/2}}
+\frac{\big[x^2+y^2+z^2\big]-y\frac{3}{2}(2y)}{{\big[x^2+y^2+z^2\big]}^{5/2}}
</mrow><mrow>
&amp;+\frac{\big[x^2+y^2+z^2\big]-z\frac{3}{2}(2z)}{{\big[x^2+y^2+z^2\big]}^{5/2}}
</mrow><mrow>
&amp;=0
</mrow>
</md>
D'autre part, le bord de <m>\cE</m> est la sphère unité <m>\cS = \partial \cE = \Set{(x,y,z)}{x^2+y^2+z^2 = 1}</m>. Le vecteur normal unitaire à <m>\cS</m> est <m>\vn = \frac{\vr}{|\vr|}</m> de sorte que
<md>
<mrow>
\iint_{\partial V}\vF\cdot\vn\ \dee{S}
&amp;=\iint_{|\vr|=1}  \frac{\vr}{|\vr|^3}\cdot \frac{\vr}{|\vr|}\ \dee{S}
=\iint_{|\vr|=1}  \frac{1}{|\vr|^2}\ \dee{S}
=\iint_{|\vr|=1}\dee{S}
</mrow><mrow>
&amp;=4\pi\ne 0
</mrow>
</md>
</p>

</example>

<p>
  Tout comme le bord d'une région du plan peut être formé de plusieurs courbes (voir par exemple la <xref ref="OpenStax-Plusieurs-trous">figure </xref>), le bord d'une région solide <m>\cR</m> de <m>\R^3</m> peut être formé de plusieurs surfaces. Dans ce cas la formule du théorème de la divergence reste valable, mais il faut orienter chaque surface convenablement, c'est à dire toujours en pointant vers l'extérieur de <m>\cR</m>. Dans le fond, c'est la même idée que celle qui a été mise à l'oeuvre à <xref ref="ex-green-bord-x2">l'exemple </xref>.
</p>
<p>
  Voyons un exemple, mais nous pourrions simplement dire que c'est la version tri-dimensionnalle de <xref ref="ex-green-bord-x2">l'exemple </xref>.
</p>


<example xml:id="ex-div-bord-x2" >
  <statement>
    <p> Soit comme avant le champ <m>\vF =\frac{\vr}{|\vr|^3}</m> (où <m>\vr = x\,\vi + y\, \vj + z\,\vk</m>).
    <ol marker = "(a)">
      <li>
        <p>Soient <m>a,b</m> deux réels tels que <m>0 \lt a \lt b</m> et <m>\cE</m> la région de <m>\R^3</m> définie par <m>a^2 \leqslant x^2+ y^2 + z^2 \leqslant b^2</m>. Calculuer le flux de <m>\vF</m> vers l'extérieur de <m>\vF</m>.

        </p>
      </li>
      <li>
        <p>
          Montrer que le flux de <m>\vF</m> à travers n'importe quelle sphère (vers l'extérieur de celle-ci) peut prendre seulement deux valeurs, selon que la sphère englobe l'origine ou pas. Calculer ces valeurs.
        </p>
      </li>
    </ol>

    </p>
  </statement>
  <solution>
    <p>
      <ol marker = "(a)">
        <li>
          <p>
            Notons que notre champ est le même que celui de <xref ref="eg_divThmD">l'exemple </xref>. Cette fois, cependant, nous n'avons aucun problème de continuité sur la région <m>\cE</m>. La formule du théorème de la divergence reste valable. Nous avons déjà calculé <m>\div{\vF} ? \vnabla \cdot \vF = 0</m>. Ainsi, le flux qui nous intéresse est
            <me>
              \iiint_{\cE} \div{\vF}\, dV = \iiint_{\cE} \vnabla \cdot \vF \, dV = 0.
            </me>
          </p>
        </li>
        <li>
          <p>
            Soit <m>\cS</m> une sphère quelconque, et supposons pour commencer que <m>\cS</m> n'englobe pas l'origine. Ceci veut dire que la distance de son centre à l'origine est strictement supérieure à son rayon. Soit <m>\cB</m> la boule limitée par notre sphère. Notre hypothèse à l'effet que l'origine n'est pas englobé dans <m>\cB</m> permet d'utiliser le théorème de la divergence, et de calculer directement
          </p>
          <me>
            \iint_{\cS} \vF \cdot d\vS = \iint_{\partial \cB} \vF \cdot d\vS = \iiint_{\cB} \vnabla \cdot \vF = 0.
          </me>
          <p>
            Supposons maintenant que <m>\cS</m> englobe l'origine. La distance du centre de <m>\cS</m> à l'origine est donc strictement inférieure à son rayon. Il existe donc <m>h\gt 0</m> tel que la sphère de rayon <m>h</m> centrée à l'origine, nommons-la <m>\cS_h</m> est totalement englobée par la sphère donnée <m>\cS</m>.
          </p>
          <p>
            Soit cette fois <m>\cV</m> la région comprise entre <m>\cS_h</m> et <m>\cS</m>, c'est à dire <m>\cV = \cS \cup \cS_h</m>. Nous avons alors, grâce au même calcul que celui de la première partie, que
          </p>
          <md>
            <mrow>0 \amp = \iiint_{\cV} \vnabla \cdot \vF\, dV = \iint_{\partial \cV} \vF \cdot d\vS =  \iint_{\cS} \vF \cdot d\vS  + \iint_{\cS_h} \vF \cdot d\vS</mrow>
          </md>
          <p>
            Comme partie de la frontière de <m>\cV</m>, la sphère <m>\cS_h</m> doit être orientée par le vecteur normal unitaire qui pointe vers l'origine, à savoir <m>-\vr / |\vr|</m>. Compte tenu de cette orientation, le calcul de la partie b de l'<xref ref="eg_divThmD">exemple </xref> nous donne
          </p>
          <me>
            \iint_{\cS_h} \vF \cdot d\vS = -4\pi.
          </me>


        </li>
      </ol>

    </p>
  </solution>
</example>



<example xml:id="eg_stokesD">
<statement>
  <p> Calculer le flux <m> \iint_{\cS}\vG\cdot d\vS </m> où  <m>\vG= (2x)\,\vi +(2z-2x)\,\vj  +(2x-2z)\,\vk </m> et
  <me>
  \cS=\Set{(x,y,z)}{z=\big(1-x^2-y^2\big)(1-y^3)\cos x\ e^{y},\ x^2+y^2\le 1}
  </me>
orientée par le vecteur normal qui pointe vers le haut.
</p>
</statement>

<solution>
<p>
La surface <m>\cS</m> est représentée dans la figure ci-bas. Elle est plutôt compliquée, mais son bord <m>\partial \cS</m> est plutôt simple, il s'agit du cercle <m>x^2+y^2=1</m>, <m>z=0</m>.
</p>
<figure xml:id="fig-ex-div-stokes">
          <caption>La surface <m>\cS</m>, en orange. En bleu la surface <m>\cS'</m>. La région <m>\cV</m> de <m>\R^3</m> est limitée par la réunion des deux surfaces. On trouve également les vecteurs normaux.</caption>

          <image xml:id="im-ex-div-stokes" platform="sage" width="100%">
            <sageplot variant="3d" aspect="1.0">
              var('r,t')
              X(r,t) = r*cos(t)
              Y(r,t) = r*sin(t)
              f(x,y) = (1-x^2 -y^2)*(1-y^3)*cos(x)*exp(y)
              fx = diff(f,x)
              fy = diff(f,y)
              x0, y0 = 0.5,0.3
              h=2*sqrt(fx(x0,y0)^2 + fy(x0,y0)^2 +1)
              Fig = parametric_plot3d([X(r,t), Y(r,t), f(X(r,t), Y(r,t)) ],
                                      (r,0,1), (t,0,2*pi), color = "orange", mesh = True,opacity = 0.65)
              Fig += parametric_plot3d([X(r,t), Y(r,t), 0 ],
                                      (r,0,1), (t,0,2*pi), color = "lightblue", mesh = False)
              Fig+= arrow3d((0.5,0.3,0),(0.5,0.3,-0.5), width=1, color = "lightblue",frame = False)
              Fig+= arrow3d((x0,y0,f(x0,y0)),(x0-fx(x0,y0)/h,y0 - fy(x0,y0)/h,
                f(x0,y0) + 1/h), width=1, color = "orange",frame = False)
              Fig += arrow3d((0,0,0),(1.5,0,0), width=0.7, color = "black",
                frame = False)
              Fig += text3d("x", (1.7,0,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,1.5,0), width=0.7, color = "black",
                frame = False)
              Fig += text3d("y", (0,1.7,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,0,1.5), width=0.7, color = "black",
                frame = False)
              Fig += text3d("z", (0,0,1.7), color = "black")
              Fig
            </sageplot>
          </image>
      </figure>

<p>
  L'évaluation de l'intégrale de surface n'est pas quelque chose de simple, les formules sont suffisamment compliquées pour qu'on veuille procéder autrement. Dans cette solution nous allons nous servir du théorème de la divergence, notamment parce que
<md>
<mrow>
\vnabla\cdot\vG = \frac{\partial }{\partial x}(2x)+
                  \frac{\partial }{\partial y}(2z-2x)+
                  \frac{\partial }{\partial z}(2x-2z)
                = 0.
</mrow>
</md>
Voici la stratégie à suivre.
<ul>
<li>
  Nous commençons pat trouver une autre surface <m>\cS'</m> telle que son bord  <m>\partial \cS'</m> soit aussi le cercle <m>x^2+y^2=1</m>, <m>z=0</m>. Un choix raisonnable pour  <m>\cS'</m>, celle que nous allons utiliser, est le disque
  <me>
    \cS' =\Set{(x,y,z)}{x^2+y^2\leqslant 1,\ z=0}
  </me>
</li>
<li>
  <p>
    Nous allons définir <m>\cV</m> comme étant le solide limité en haut par <m>\cS</m> et en bas par <m>\cS'</m>. Ainsi, le bord de <m>\cV</m> est  <m>\cS \cup \cS'</m>.
</p>

</li>
<li> Nous aurons alors
<me>
\iiint_{\cV} \vnabla\cdot\vG\,\dee{V}
=\iint{\cS}\vG\cdot\, d\vS + \iint_{\cS'} \vG\cdot\, d\vS
</me>
Le terme de gauche est nul, puisque <m>\vnabla\cdot\vG=0</m>. Ainsi,
<me>
\iint_{\cS}\vG\cdot\, d\vS
= - \iint_{\cS'} \vG\cdot\, d\vS
</me>
</li>
<li>  Le vecteur normal pour  <m>\cS'</m>  est <m>-\vk</m>, car il doit pointer vers l'extérieur de <m>\cV</m>.
</li>
</ul>
</p>

<p> Nous pouvons à présent calculuer
<md>
<mrow>
\iint_{\cS}\vG\cdot\, d\vS
&amp;=-\iint_{\cS'} \vG\cdot d\vS
= - \iint_{\cS'} \vG\cdot \vn\,  dS
</mrow>
<mrow>
&amp;= - \iint_{\cS'} \vG\cdot (-\vk) dS
= - \iint_{\Atop{x^2+y^2\le 1}{z=0}}(2x-2z)\,\dee{x}\dee{y}
</mrow><mrow>
&amp;=\iint_{\Atop{x^2+y^2\le 1}{z=0}}(2x)\, dA
</mrow><mrow>
&amp;=0
</mrow>
</md>
puisque le domaine d'intégration est symétrique par rapport à l'axe <m>x=0</m> et la fonction est une fonction impaire.
</p>
</solution>

<solution>
<p>
Pour cette deuxième solution, nous utiliserons plutôt le théorème de Stokes. Puisque <m>\vnabla \cdot \vG = 0</m>, à la lumière du <xref ref = "thm-rot-grad-zero">théorème </xref>, il est permis de penser qu'il existe un champ <m>\vF </m> tel que <m>\vG = \vnabla \times \vF</m>. Un tel champ est appelé un <term>potentiel vectoriel</term> pour <m>\vG</m>. Si c'était effectivement le cas, nous aurions, en vertu du théorème de Stokes,
<me>
  \iint_{\cS} \vG\cdot d\vS = \iint_{\cS} (\vnabla \times \vF)\cdot d\vS = \int_{\partial \cS}\vF \cdot d\vr
</me>
où <m>\cC = \partial \cS</m> est le cercle <m>x^2 + y^2 = 1</m> du plan <m>z=0</m>.
</p>
<figure xml:id="fig-ex-div-stokes-b">
          <caption>La surface <m>\cS</m>, en orange, et son bord, en rouge.</caption>

          <image xml:id="im-ex-div-stokes-b" platform="sage" width="100%">
            <sageplot variant="3d" aspect="1.0">
              var('r,t')
              X(r,t) = r*cos(t)
              Y(r,t) = r*sin(t)
              f(x,y) = (1-x^2 -y^2)*(1-y^3)*cos(x)*exp(y)
              fx = diff(f,x)
              fy = diff(f,y)
              x0, y0 = 0.5,0.3
              h=2*sqrt(fx(x0,y0)^2 + fy(x0,y0)^2 +1)
              Fig = parametric_plot3d([X(r,t), Y(r,t), f(X(r,t), Y(r,t)) ],
                                      (r,0,1), (t,0,2*pi), color = "orange", mesh = True,opacity = 0.65)
              Fig += parametric_plot3d([X(1,t), Y(1,t), 0 ],
                                      (t,0,2*pi), color = "red", thickness= 2)
              Fig+= arrow3d((x0,y0,f(x0,y0)),(x0-fx(x0,y0)/h,y0 - fy(x0,y0)/h,
                f(x0,y0) + 1/h), width=1, color = "orange",frame = False)
              Fig += arrow3d((0,0,0),(1.5,0,0), width=0.7, color = "black",
                frame = False)
              Fig += text3d("x", (1.7,0,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,1.5,0), width=0.7, color = "black",
                frame = False)
              Fig += text3d("y", (0,1.7,0), color = "black",frame = False)
              Fig += arrow3d((0,0,0),(0,0,1.5), width=0.7, color = "black",
                frame = False)
              Fig += text3d("z", (0,0,1.7), color = "black")
              Fig
            </sageplot>
          </image>
      </figure>

<p>
  Cherchons donc un potentiel vectoriel <m>\vF = P \, \vi + Q\,\vj + R\, \vk</m>. Supposons pour commencer que <m>R = 0</m>, de sorte que <m>\vF = P\, \vi + Q\,\vj</m> et l'égalité <m>\vnabla \times \vF = \vG</m> se traduit par les égalités
  <md>
    <mrow> - Q_z \amp = 2x  </mrow>
    <mrow> P_z \amp = 2z -2x</mrow>
    <mrow> Q_x - P_y \amp= 2x-2z</mrow>
  </md>
  L'intégration de la première égalité par rapport à <m>z</m> donne
  <me>
    Q(x,y,z) = -2xz + \phi(x,y)
  </me>
  pour une certaine fonction <m>\phi.</m>
</p>

<p>De la même façon, l'intégration de la deuxième égalité, toujours par rapport à <m>z</m> donne
<me>
  P(x,y,z) = z^2 -2xz + \psi(x,y)
</me>
pour une certaine fonction <m>\psi</m>.
</p>
<p>Finalement, la troisième égalité est satisfaite si et seulement si

<md>
  <mrow>\pdiff{}{x}\left(-2xz+ \phi\right)) - \pdiff{}{y}\left(z^2 -2xz+\psi\right) \amp = 2x-2z</mrow>
  <mrow>\Leftrightarrow -2x+\phi_x - \psi_ y = 2x-2z</mrow>
  <mrow>\Leftrightarrow \amp \phi_x - \psi_y = 2x </mrow>
</md>
Un choix possible est <m>\phi(x,y) = x^2</m> et <m>\psi(x,y) = 0</m>. Ceci conduit à <m>\vF = (z^1 +2xz)\vi + (x^2 -2xz)\vj + 0\vk</m>. On vérifie en effet que <m>\vnabla \times \vF = \vG</m>, comme on le voulait.
</p>
<p>Le cercle <m>\cC = \partial \cS</m> peut être paramétré par <m>\vr(t) = \cos t\, \vi + \sin t\, \vj + 0 \vk</m> pour <m>t\in[0,2\pi]</m> (l'orientation est compatible avec celle de <m>\cS</m>). On calcule alors
<md>
  <mrow>\int_{\cC}\vF \cdot d\vr \amp = \int_{\cC} (z^2 -2xz)\, dx + (x^2 -2xz)\, dy </mrow>
  <mrow>\amp = \int_{\cC}x^2 \ dy = \int_0^{2\pi}\cos^2 t\cdot \cos t\, dt =0</mrow>
</md>

</p>

</solution>
</example>

<p>
Voyons maintenant quelques variations souvent utiles du théorème de la divergence.
</p>

<theorem xml:id="thm_divVrn">
  <title>Variations du Théorème de la divergence </title>
<statement><p>
Soit <m>\cV</m> un solide dont le bord est une surface <m>\partial \cV</m>, alors <md>
<mrow>
\iint_{\partial \cV} \vF\cdot\vn \,\dee{S}
&amp;=\iiint_{\cV} \vnabla\cdot\vF\ \dee{V}
</mrow><mrow>
\iint_{\partial \cV} f \vn \,\dee{S}
&amp;=\iiint_{\cV} \vnabla f\ \dee{V}
</mrow><mrow>
\iint_{\partial \cV} \vn \times\vF\,\dee{S}
&amp;=\iiint_{\cV} \vnabla\times\vF\ \dee{V}
</mrow>
</md>
où <m>\vn </m> est le vecteur normal unitaire à  <m>\partial \cV</m> pointant vers l'extérieur.
</p></statement>
</theorem>

<p><alert>Aide mémoire.</alert> Les trois formules peuvent être combinées en
<me>
\iint_{\partial \cV} \vn  \ast \tilde F\,\dee{S}
=\iiint_{\cV} \vnabla \ast \tilde F\ \dee{V}
</me>
où  <m>\ast </m> peut être  <m>\cdot</m> (un produit scalaire), <m>\times</m> (un produit vectoriel) ou rien du tout (le produit d'un vecteur par un scalaire). Lorsque <m>\ast =\cdot</m> ou <m>\ast =\times</m>, alors <m>\tilde F=\vF</m>. Lorsque <m>\ast </m> n'est rien du tout, <m>\tilde F=f</m>, une fonction à valeurs scalaires.
</p>

<proof>
<p>
La première formule n'est rien d'autre que le théorème de la divergence, c'est la formule du <xref ref="thm_divThm">théorème </xref>.
</p>

<p>
Afin de démontrer la deuxième formule, soit  <m>\vF=f\va</m>, où <m>\va</m> est un vecteur constant, et appliquons le théorème de la divergence.
<md>
<mrow>
\iint_{\partial \cV} f\va\cdot\vn \,\dee{S}
&amp;=\iiint_{\cV} \vnabla\cdot(f\va)\ \dee{V}
</mrow><mrow>
&amp;=\iiint_{\cV} \big[(\vnabla f)\cdot\va
+f\underbrace{\vnabla\cdot\va}_{=0}\big]\ \dee{V}
</mrow><mrow>
&amp;=\iiint_{\cV} (\vnabla f)\cdot\va\ \dee{V}
</mrow>
</md>
Pour utiliser le deuxième ligne, nous avons utilisé la formule du théorème <xref ref="thm_divIdentities">théorème </xref>.c. Pour avoir la troisème ligne, nous avons simplement utilisé le fait que  <m>\va</m> est constant, de sorte que toutes les dérivées sont nulles. On peut écrire de façon équivalente
<me>
\iiint_{\cV} (\vnabla f)\cdot\va\ \dee{V}
=\iiint_{\cV} \va\cdot(\vnabla f)\ \dee{V}
</me>
Puisque <m>\va</m> est constant, on peut le mettre en évidence, de sorte que
<md>
<mrow>
&amp;\va\cdot\iint_{\partial \cV} f\vn \,\dee{S}
=\va\cdot\iiint_{\cV} \vnabla f\ \dee{V}
</mrow><mrow>
\implies &amp;\va\cdot\bigg\{\iint_{\partial \cV} f\vn \,\dee{S}
-\iiint_{\cV} \vnabla f\ \dee{V}\bigg\}=0
</mrow>
</md>
En particulier, en choisissant <m>\va=\vi</m>, <m>\vj</m> et <m>\vk</m>, nous obtenons que les trois composantes du vecteur  <m>\iint_{\partial \cV} f\vn \,\dee{S} -\iiint_{\cV} \vnabla f\ \dee{V}</m> sont nulles. Il vient donc
<me>
\iint_{\partial \cV} f\vn \,\dee{S}
-\iiint_{\cV} \vnabla f\ \dee{V}=0
</me>
qui est l'égalité que nous voulions établir.
</p>

<p>
Afin d'établir la validité de la troisième formule, on applique le théorème de la divergence au champ  <m>\va\times\vF</m>, où  <m>\va</m> est n'importe quel vecteur constant.
<md>
<mrow>
&amp;\iint_{\partial \cV} (\va\times\vF)\cdot\vn \ \dee{S}
=\iiint_{\cV} \vnabla\cdot(\va\times\vF)\ \dee{V}
</mrow><mrow>
&amp;\hskip0.5in=\iiint_{\cV} \big[\vF\cdot\underbrace{(\vnabla \times \va)}_{=\vZero}
  -\va\cdot(\vnabla\times\vF)\big]\ \dee{V}
</mrow><mrow>
&amp;\hskip0.5in=-\iiint_{\cV} \va\cdot(\vnabla \times\vF)\ \dee{V}
=-\va\cdot\iiint_{\cV} \vnabla \times\vF\ \dee{V}
</mrow>
</md>
Pour obtenir la deuxième ligne, nous avons utilisé l'identité établie à la  <xref ref="thm_divIdentities">partie d., théorème </xref> Pour obtenir la troisième ligne, nous utilisons à nouveau le fait que <m>\va</m> est constant, de sorte que ses dérivées sont nullles. Nous avons aussi une identité concernant una combinaison du produit vectoriel et le produit scalaire : <m>(\va\times\vb)\cdot\vc=\va\cdot(\vb\times\vc)</m> (ceci a été établi à la partie a. de la <xref ref="prop-vect-bis">proposition</xref>. Ainsi
<me>
(\va\times\vF)\cdot\vn
=\va\cdot(\vF\times\vn )
</me>
et
<md>
<mrow>
&amp;\va\cdot\iint_{\partial \cV} \vF\times\vn\ \dee{S}
=-\va\cdot\iiint_{\cV} \vnabla \times\vF\ \dee{V}
</mrow><mrow>
\implies &amp;\va\cdot\bigg\{\iint_{\partial \cV} \vF\times\vn\ \dee{S}
+\iiint_{\cV} \vnabla\times\vF\ \dee{V}\bigg\}=0
</mrow>
</md>
En particulier, en choisissant  <m>\va=\vi</m>, <m>\vj</m> et <m>\vk</m>, nous voyons que les trois composantes du vecteur <m>\iint_{\partial \cV} \vF\times\vn\ \dee{S} +\iiint_{\cV} \vnabla\times\vF\ \dee{V}</m> sont nulles. Ainsi
<me>
\iiint_{\cV} \vnabla\times\vF\ \dee{V}
=-\iint_{\partial \cV} \vF\times\vn\ \dee{S}
=\iint_{\partial \cV} \vn \times\vF\ \dee{S}
</me>
qui est precisément ce que nous voulions.
</p>

</proof>

</subsection>

<subsection xml:id="sec_heatEqn">
  <title>Application : l'équation de la chaleur</title>

  <p>
    Soit <m>T(x,y,z,t)</m> la température au temps  <m>t</m> au point <m>(x,y,z)</m> pour un objet occupant une région <m>\cB</m> de l'espace. L'équation de la chaleur <fn>L'équation de la chaleur a été formulée par le mathématicien et physicien français Jean-Baptiste Joseph Fourier en 1807. Il a vécu de 1768 à 1830, une période qui comprend à la fois la Révolution française et le règne de Napoléon. Fourier a fait partie du comité révolutionnaire local, a été brièvement emprisonné pendant la Terreur et a été le conseiller scientifique de Napoléon Bonaparte lors de son expédition en Égypte en 1798. Les séries de Fourier et la transformée de Fourier portent son nom. On lui attribue également la découverte de l'effet de serre.</fn> est l'équation aux dérivées partielles qui décrit le flux d'énergie thermique, et donc le comportement de <m>T</m>. Montrons comment le théorème de la divergence permet de déduire l'équation de la chaleur à partir de certaines  <q>lois</q>, de la physique que nous prennons pour acquises :
      <ul>
    <li>
      La quantité d'énergie pour agumenter la température d'un objet de  <m>\De T</m> degrés est <m>CM\,\De T</m> où, <m>M</m> est la masse de l'objet et  <m>C</m> est une constante positive déterminée par le matériau duquel l'objet est fait, c'est ce qu'on appelle la <q>chaleur spécifique</q><fn>On comprend maintenant que la chaleur provient de l'énergie interne de l'objet. Dans une théorie antérieure, la chaleur était considérée comme la mesure d'un fluide invisible, appelé calorique. Le médecin et chimiste écossais Joseph Black (1728-1799) a appelé le <q>calorique</q>. La quantité de calorique qu'un objet peut contenir était appellée la <q> capacité calorique</q> par le médecin et chimiste écossais
      Joseph Black (1728<ndash/>1799).</fn>, de l'objet.
    </li>
    <li><p>
      Pensons à l'énergie thermique comme un fluide en mouvement. Nous allons considérer son champ de vitesses de sorte que la chaleur dans la direction opposée à celle du gradient de température, c'est à dire <m>-\ka\vnabla T(x,y,z,t)</m>.
      Ici <m>\ka</m> est une autre constante positive, appellée la <q>conductivité thermique</q> de l'objet. Ainsi, le taux avec lequel la chaleur est conduite à travers une portion de surface d'aire <m>\dee{S}</m> au point  <m>(x,y,z)</m> dans la direction du vecteur normal <m>\vn</m> est donnée par <m>-\ka\vn\cdot\vnabla T(x,y,z,t)\,\dee{S}</m> au temps <m>t</m>. (voir le  <xref ref="lem_fluxInterp"/> au besoin.) Par exemple, dans la figure
      </p>

      <sidebyside width="25%">
      <image source="images/CLP4-figs/heat1-JC"/>
      </sidebyside>

      <p>
      le gradient de température, qui pointe dans la direction d'augmentation de température est l'opposé de <m>\vn</m>. En conséquence, le taux de flux <m>-\ka\vn\cdot\vnabla T(x,y,z,t)\,\dee{S}</m> est  positif, ce qui indique le flux dans la direction de  <m>\vn</m>. Ceci correspond à ce qu'on attend <mdash /> la chaleur <q>s'écoule</q> des régions chaudes vers les régions froides. De plus, le taux de flux grandit à mesure que la norme du gradient de température grandit. Ceci fait du sens, et rappelle la loi du refroidissement de Newton.
      </p>
    </li>
      </ul>


    Soit  <m>\cV\subset\cB</m>  <em>n'importe quelle</em><fn>Il faut tout de même que sa frontrière soit sufisament raisonnable pour pouvoir appliquer nos théorèmes</fn> partie dans notre objet, soit <m>\partial \cV</m> sa frontière et <m>\vn</m> un vecteur normal à <m>\partial \cV</m> pointant vers l'extérieur de <m>\cV</m>. La quantité de chaleur qui <em>entere</em> dans  <m>\cV</m> à travers un petit morceau de surface <m>\dee{S}</m> de <m>\partial \cV</m> pendant un petit intervalle de temps <m>\dee{t}</m> est <m>-\big(-\ka\vn\cdot\vnabla T(x,y,z,t)\,\dee{S}\big)\,\dee{t}</m>. La quantité de chaleur qui entre dans <m>V</m> à travers toute sa fonritère <m>\partial \cV</m> pendant cet intervalle de temps est donnée par
  </p>

  <sidebyside widths="45% 27%" valign="middle">
  <p><me>
  \iint_{\partial V} \ka\vn\cdot\vnabla T(x,y,z,t)\,\dee{S}\,\dee{t}
  </me></p>
  <image source="images/CLP4-figs/heat2"/>
  </sidebyside>

  <p>
    Pendant cette même prériode de temps, la températur au point <m>(x,y,z)</m> dans  <m>\cV</m> varie de <m>\frac{\partial T}{\partial t}(x,y,z,t)\,\dee{t}</m>. Si la densité de l'objet au point  <m>(x,y,z)</m> est <m>\rho(x,y,z)</m>, la quantité d'énergie requise pour faire accroitre la température d'un petit morceau de volume <m>\dee{V}</m> centré à  <m>(x,y,z)</m> de <m>\frac{\partial T}{\partial t}(x,y,z,t)\,\dee{t}</m> est  <m>C(\rho\dee{V})\,\frac{\partial T}{\partial t}(x,y,z,t)\,\dee{t}</m>. La quantité d'énergie requise pour accroître la température de toute la région <m>\cV</m> de  <m>\frac{\partial T}{\partial t}(x,y,z,t)\,\dee{t}</m> est alors
    <me>
    \iiint_{\cV} C\rho\frac{\partial T}{\partial t}(x,y,z,t)\,\dee{V}\,\dee{t}
    </me>

    Supposons maintenant que notre objet ne dissipe ni engendre de la chaleur <fn>La théorie du <q>calorique</q> a elle-même été refutée par l'expérience dy physicien états-unien / britannique Benjamin Thompson (1753<ndash/>1814) qui a réussi a faire boullir de l'eau en utilisant la chaleur engendrée par la friction pendant l'alésage d'un canon.</fn> par lui-même. Ainsi, cette quantité doit être égale à la quantité de chaleur qui entre dans <m>\cV</m> pendant ce laps de temps, c'est à dire
    <me>
    \iint_{\partial V} \ka\vn\cdot\vnabla T\,\dee{S}\,\dee{t}
    =\iiint_{\cV} C\rho\frac{\partial T}{\partial t}\,\dee{V}\,\dee{t}
    </me>
    Intégrer par rappport à <m>t</m> nous permet, en quelque sorte de sumplifier <m>\dee{t}</m>. Nous pouvons écrire l'expression de gauche comme une intégrale triple sur tout  <m>\cV</m>, grâce au théorème de la divergence, ce qui donne
    <me>
    \iiint_{\cV} \ka\vnabla\cdot\vnabla T\,\dee{V}
    =\iiint_{\cV} C\rho\frac{\partial T}{\partial t}\,\dee{V}
    </me>
    Comme ces deux intégrales ont le même domaine, nous avons
    <md>
      <mrow>
        &amp;\iiint_{\cV} \ka\vnabla\cdot\vnabla T\,\dee{V}
        -\iiint_{\cV} C\rho\frac{\partial T}{\partial t}\,\dee{V} =0
      </mrow>
      <mrow>
          &amp;\hskip1in\implies
            \iiint_{\cV} \left[\ka\vnabla^2 T - C \rho\frac{\partial T}{\partial t}\right]\,\dee{V}=0
            \tag{H}
      </mrow>
    </md>
    où <m>\vnabla^2=\vnabla\cdot\vnabla=\frac{\partial^2 }{\partial x^2} +
\frac{\partial^2 }{\partial y^2}+\frac{\partial^2 }{\partial z^2}</m> est le laplacien. Ceci étant vrai pour toute région <m>\cV</m>, et pour tout instant <m>t</m>, nous prétendos qu'il faut nécessairement avoir
<me>
\ka\vnabla^2 T(x,y,z,t)-C\rho\frac{\partial T}{\partial t}(x,y,z,t)=0
</me>
pour tout <m>(x,y,z)\in \cB</m> et pour tout  <m>t</m>.
</p>

<p>En effet, supposons au contraire qu'il existe un point  <m>(x_0,y_0,z_0)</m> dans <m>\cB</m> et un instant  <m>t_0</m> tels  que, par exemple, <m>\ka\vnabla^2 T(x_0,y_0,z_0,t_0)    -C\rho\frac{\partial T}{\partial t}(x_0,y_0,z_0,t_0) \gt 0</m>. En vertu de la continuité <m>\ka\vnabla^2 T(x,y,z,t_0) - C\rho\frac{\partial T}{\partial t}(x,y,z,t_0)</m> doit être près de  <m>\ka\vnabla^2 T(x_0,y_0,z_0,t_0)   -C\rho\frac{\partial T}{\partial t}(x_0,y_0,z_0,t_0)</m> lorsque <m>(x,y,z)</m> est proche de  <m>(x_0,y_0,z_0)</m>. Ainsi, nous aurions
<me>
\ka\vnabla^2 T(x,y,z,t_0) -C\rho\frac{\partial T}{\partial t}(x,y,z,t_0) \gt 0
</me>
pour  <m>(x,y,z)</m> dans une petite sphère <m>\cE</m> centrée à <m>(x_0,y_0,z_0)</m>.
Alors
<me>
\iint_{\cE} \Big[\ka\vnabla\cdot\vnabla T(x,y,z,t_0)
      -C\rho\frac{\partial T}{\partial t}(x,y,z,t_0)\Big]\,\dee{V} \gt 0
</me>
ce qui contredit l'équation (H) lorsque  <m>\cV=\cE</m>.  Nous avons dont établi l'équation de la chaleur, à savoir
</p>

<fact xml:id="eqn_heat">
  <statement>
    <p>
<me>
\frac{\partial T}{\partial t}(x,y,z,t)
=\alpha \vnabla^2 T(x,y,z,t)
</me>
où <m>\alpha=\frac{\ka}{C\rho}</m> est appelée la <em>conductivité thermique </em>.
</p>
</statement>
</fact>


<p>
En guise d'application, étudions la température à une certaine distance de la surface de la Terre. Pour simplifier, supposons que la Terre est plate et que la température  <m>T</m>, dépend seulement du temps <m>t</m>, et de la profondeur, <m>z</m>. Dans ce contexte, l'équation de la chaleur devient
<me>
\frac{\partial T}{\partial t}(z,t)
=\alpha \frac{\partial^2 T}{\partial z^2}(z,t)
\tag{HE}
</me>
Nous choisissons notre systè de coordonnés de sorte que la surface de la Terre correspond à  <m>z=0</m> et de sorter que <m>z</m> augmente à mesure qu'on descend. Nous supposerons aussi que la température à la surface, <m>T(0,t)</m> est principalement déterminée par le soleil et est donnée par
<me>
T(0,t)=T_0+T_A\cos(\sigma t)+T_D\cos(\delta t)
\tag{BC}
</me>
Ici <m>T_0</m> est la température moyenne à long terme, <m>T_A\cos(\sigma t)</m> prend e compte des variations saisonnières, tandis que <m>T_D\cos(\delta t)</m> donne les variations quotidiennes.
</p>

<sidebyside width="94%">
<image source="images/CLP4-figs/heat3-FR"/>
</sidebyside>

<p>
  Nous mesurons le temps en jours, de sorte que <m>\delta =2\pi</m> et <m>\sigma =\frac{2\pi}{1\ {\rm year}}=\frac{2\pi}{365{\rm days}}</m>. Alors  <m>T_A\cos(\sigma t)</m> a une période d'un an et <m>T_D\cos(\delta t)</m> a une pédiode d'un jour. La solution du problème à valeurs initiales (HE)+(BC) peut être trouvée avec la méthode de séparation des variables, un sujet standard dans les cours d'équations différentielles. La solution est
  <md>
    <mrow>
    T(z,t)&amp;=T_0
    +T_Ae^{-\sqrt{\sigma \over 2\alpha}\ z}
        \cos\Big(\sigma t-\sqrt{\frac{\sigma }{2\alpha}}\ z\Big)
    </mrow><mrow>
    &amp;\hskip1in+T_De^{-\sqrt{\delta \over 2\alpha}\ z}
    \cos\Big(\delta t-\sqrt{\frac{\delta }{2\alpha}}\ z\Big)
    \tag{SLN}
    </mrow>
  </md>
Il est routinier de vérfier que (SLN) est en effet solution de  (HE) et (BC).
</p>

<p>
  Voyons maintenant ce qu'on peut tirer de la solution de (SLN). Pour une profondeur fixe <m>z</m>, la moyenne par rapport au temps de  <m>T(z,t)</m> est <m>T_0</m> (simplement parceque la valeur moyenne de la fonction cosinus est nulle), la même que la température moyenne à la surface, c'est à dire lorsque <m>z=0</m>.
</p>

<p>Le terme
<m>T_Ae^{-\sqrt{\sigma \over 2\alpha}\ z}
           \cos\Big(\sigma t-\sqrt{\frac{\sigma }{2\alpha}}\   z\Big)</m>
  <ul>
  <li>
    introduit une oscillation de période un an, tout comme  <m>T_A\cos(\sigma t)</m>
  </li>
  <li>
    a une amplitude  <m>T_Ae^{-\sqrt{\sigma \over 2\alpha}\ z}</m> qui vaut  <m>T_A</m> à la surface et décroît exponentiellement à mesure que  <m>z</m> grandit. Un acroissement de la profondeur  <m>z</m> de <m>\sqrt{\frac{2\alpha}{\sigma}}</m> entraîne une diminution de l'amplitude de l'oscillation d'un facteur <m>\frac{1}{e}</m>. Ces deux preières observations sont probablement en accord avec notre intuition, mais la solution a aussi une troisième propriété, qui est peut être moins évidente.
  </li>
  <li>
    Elle a un décalage dans le temps de <m>\frac{z}{\sqrt{2\alpha\sigma}}</m> par rapport à  <m>T_A\cos(\sigma t)</m>. Le terme pour la surface, <m>T_A\cos(\sigma t)</m> atteint son maximum lorsque <m>t=0,\ \frac{2\pi}{\sigma},\ \frac{4\pi}{\sigma},\ \cdots</m>. À une profondeur <m>z</m> le terme correspondant  <m>T_Ae^{-\sqrt{\sigma \over 2\alpha}\ z}
          \cos\Big(\sigma t-\sqrt{\frac{\sigma }{2\alpha}}\ z\Big)</m> atteint son maximum lorsque  <m>\ \sigma t-\sqrt{\frac{\sigma }{2\alpha}}\ z
          =0,\ 2\pi, 4\pi,\ \cdots</m> de sorte que  <m>t=\frac{z}{\sqrt{2\alpha\sigma}},\ \frac{2\pi}{\sigma}+\frac{z}{\sqrt{2\alpha\sigma}},\ \frac{4\pi}{\sigma}+\frac{z}{\sqrt{2\alpha\sigma}},\ \cdots</m>.
  </li>
  </ul>
De la même façon, le terme
<m>T_De^{-\sqrt{\delta \over 2\alpha}\ z}
          \cos\Big(\delta t-\sqrt{\frac{\delta }{2\alpha}}\ z\Big)</m>
<ul>
<li>
varie dans le temps avec une période d'une journée, tout comme <m>T_D\cos(\delta t)</m>
</li>
<li>
a une amplitude qui vaut <m>T_D</m> à la surface  et décroît exponentiellement d'un facteur  <m>\frac{1}{e}</m> pour une augmentation de
<m>\sqrt{\frac{2\alpha}{\delta}}</m>  de la profondeur.
</li>
<li>
a un décalage dans le temps de  <m>\frac{z}{\sqrt{2\alpha\delta}}</m> par rapport à <m>T_D\cos(\delta t)</m>.
</li>
</ul>
Pour l'eau, la valeur de <m>\alpha</m> est approximativement
 <m>0.012</m> m<m>^2</m>/jour. Cette valeur de  <m>\alpha</m> donne
<me>
\sqrt{\frac{2\alpha}{\sigma}}\approx  1.2\,{\rm m}\quad
\sqrt{\frac{2\alpha}{\delta}}\approx    0.062\,{\rm m} \quad
\frac{z}{\sqrt{2\alpha\sigma}}\approx 49\, z\,{\rm jours} \quad
\frac{z}{\sqrt{2\alpha\delta}}\approx 2.6\, z\,{\rm jours}
</me>
pour  <m>z</m> mesurée en centimètres. Ainsi, à une profondeur de quelques mètres la température est relativement constante dans le temps. Ce qui varie est décalé par rapport à la surface de quelques mois.
</p>





</subsection>





<xi:include  href="./Problemes/Prob-sec-Divergence.ptx"/>

</section>
